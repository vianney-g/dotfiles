#!/bin/sh

# SYSTEM WIDE SNIPPETS!!!

# To make a snippet, create a file in ~/dotfile/snippets
# If the file is executable, it is executed and the result is pasted in the app you presently are.
# Otherwise content of file is pasted in the app you presently are.

SNIPS=${HOME}/dotfiles/snippets
FILE=$(ls ${SNIPS} | /usr/bin/rofi -dmenu -p 'snippets')
SNIPPET="${SNIPS}/${FILE}"

execute_file() {
	bash "${SNIPPET}"
}

read_file() {
	if [ 1 -eq $(wc -l <${SNIPPET}) ]; then
		head --bytes=-1 ${SNIPPET}
	else
		cat ${SNIPPET} | /usr/bin/rofi -dmenu -p 'snippet'
	fi
}

if [ -f ${SNIPPET} ]; then
	DATA=$([ -x "${SNIPPET}" ] && execute_file || read_file)
	printf "$DATA" | xsel -p -i
	printf "$DATA" | xsel -b -i
	xdotool key shift+Insert
fi
